<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Python & React Chatbot</title>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script async src="https://ga.jspm.io/npm:es-module-shims@1.7.0/dist/es-module-shims.js"></script>
  <script type="importmap">
  {
    "imports": {
      "react": "https://esm.sh/react?dev",
      "react-dom/client": "https://esm.sh/react-dom/client?dev"
    }
  }
  </script>
  <style>
    /* Reset & Base Styles */
    * { box-sizing: border-box; }
    
    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
      background-color: #f0f2f5; 
      margin: 0; 
      display: flex; 
      flex-direction: column;
      justify-content: center; 
      align-items: center; 
      min-height: 100vh;
      padding: 10px; /* Î›Î¯Î³Î¿ ÎºÎµÎ½ÏŒ Î³ÏÏÏ‰-Î³ÏÏÏ‰ ÏƒÏ„Î± ÎºÎ¹Î½Î·Ï„Î¬ */
    }

    #chat-container { 
      width: 100%; 
      max-width: 500px; /* ÎœÎ­Î³Î¹ÏƒÏ„Î¿ Ï€Î»Î¬Ï„Î¿Ï‚ ÏƒÎµ desktop */
      height: 80vh; /* 80% Ï„Î¿Ï… ÏÏˆÎ¿Ï…Ï‚ Ï„Î·Ï‚ Î¿Î¸ÏŒÎ½Î·Ï‚ */
      max-height: 700px;
      background: white; 
      border-radius: 15px; 
      box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
      display: flex; 
      flex-direction: column; 
      overflow: hidden; 
      background: #f9f9f9;
    }

    #messages-area { 
      flex: 1; 
      padding: 15px; 
      overflow-y: auto; 
      display: flex; 
      flex-direction: column; 
      gap: 10px; 
    }
    
    .message { 
      max-width: 85%; 
      padding: 10px 15px; 
      border-radius: 18px; 
      font-size: 15px; 
      line-height: 1.4; 
      word-wrap: break-word; /* Î“Î¹Î± Î½Î± Î¼Î·Î½ Î²Î³Î±Î¯Î½Î¿Ï…Î½ Ï„Î± Î¼ÎµÎ³Î¬Î»Î± ÎºÎµÎ¯Î¼ÎµÎ½Î± Î­Î¾Ï‰ */
    }

    .user { 
      background: linear-gradient(135deg, #0084ff, #00a2ff); 
      color: white; 
      align-self: flex-end;
      box-shadow: 0 4px 10px rgba(0, 132, 255, 0.2);
    }

    .bot { 
      background: #ffffff; 
      color: #333; 
      align-self: flex-start;
      border: 1px solid #e4e6eb;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    #input-area { 
      padding: 15px; 
      border-top: 1px solid #eee; 
      display: flex; 
      gap: 8px; 
      background: white;
    }

    input { 
      flex: 1; 
      padding: 12px; 
      border: 1px solid #ddd; 
      border-radius: 20px; 
      outline: none; 
      font-size: 16px; /* 16px ÎµÎ¼Ï€Î¿Î´Î¯Î¶ÎµÎ¹ Ï„Î¿ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ Î¶Î¿Ï…Î¼ ÏƒÏ„Î¿ iPhone */
    }

    button.send-btn { 
      background: #0084ff; 
      color: white; 
      border: none; 
      padding: 0 20px; 
      border-radius: 20px; 
      cursor: pointer; 
      font-weight: bold;
      transition: background 0.2s;
    }

    button.send-btn:hover { background: #0073e6; }
    button:disabled { background: #ccc; cursor: not-allowed; }

    .clear-btn {
      margin-bottom: 10px;
      padding: 8px 16px;
      border-radius: 10px;
      border: 1px solid #ddd;
      background: white;
      cursor: pointer;
      font-size: 14px;
    }

    /* Media Query Î³Î¹Î± Ï€Î¿Î»Ï Î¼Î¹ÎºÏÎ­Ï‚ Î¿Î¸ÏŒÎ½ÎµÏ‚ */
    @media (max-width: 480px) {
      #chat-container {
        height: 90vh; /* Î Î¹Î¬Î½ÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿ ÏÏˆÎ¿Ï‚ ÏƒÏ„Î¿ ÎºÎ¹Î½Î·Ï„ÏŒ */
        border-radius: 10px;
      }
      .message {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel" data-type="module">
    import React, { useState, useEffect, useRef } from 'react';
    import { createRoot } from 'react-dom/client';

    const API_BASE_URL = "https://sotch13-ai-chatbot-assistant.hf.space";

    function TypewriterText({ text }) {
      const [displayedText, setDisplayedText] = React.useState("");
      React.useEffect(() => {
        let i = 0;
        const timer = setInterval(() => {
          setDisplayedText((prev) => prev + text.charAt(i));
          i++;
          if (i >= text.length) clearInterval(timer);
        }, 20);
        return () => clearInterval(timer);
      }, [text]);
      return <span>{displayedText}</span>;
    }
    
    function App() {
      const [messages, setMessages] = useState([
        { sender: "bot", text: "Î“ÎµÎ¹Î± ÏƒÎ¿Ï…! Î¤Î¿ chatbot ÎµÎ¯Î½Î±Î¹ live. Î ÏÏ‚ Î¼Ï€Î¿ÏÏ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÏ‰;" }
      ]);
      const [input, setInput] = useState("");
      const [isTyping, setIsTyping] = useState(false);
      const messagesEndRef = useRef(null);

      useEffect(() => {
        messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
      }, [messages]);

      const sendMessage = async () => {
        if (!input.trim() || isTyping) return;

        const userMsg = { sender: "user", text: input };
        setMessages(prev => [...prev, userMsg]);
        const currentInput = input;
        setInput("");
        setIsTyping(true);

        try {
          const response = await fetch(`${API_BASE_URL}/api/chat`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ text: currentInput })
          });
          
          const data = await response.json();
          setMessages(prev => [...prev, { sender: "bot", text: data.reply }]);
        } catch (error) {
          setMessages(prev => [...prev, { sender: "bot", text: "âŒ Î£Ï†Î¬Î»Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚!" }]);
        } finally {
          setIsTyping(false);
        }
      };

      const clearChat = async () => {
        try {
          await fetch(`${API_BASE_URL}/api/clear`, { method: 'POST' });
          setMessages([{ sender: "bot", text: "Î— Î¼Î½Î®Î¼Î· ÎºÎ±Î¸Î±ÏÎ¯ÏƒÏ„Î·ÎºÎµ!" }]);
        } catch (e) {
          alert("Î£Ï†Î¬Î»Î¼Î±.");
        }
      };

      return (
        <React.Fragment>
          <button className="clear-btn" onClick={clearChat}>
            ğŸ—‘ï¸ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚
          </button>
          
          <div id="chat-container">
            <div style={{ padding: '15px', background: '#0084ff', color: 'white', textAlign: 'center', fontWeight: 'bold' }}>
              Python AI Chat (Live)
            </div>
            
            <div id="messages-area">
              {messages.map((msg, index) => (
                <div key={index} className={`message ${msg.sender}`}>
                  {msg.sender === "bot" && index === messages.length - 1 ? (
                    <TypewriterText text={msg.text} />
                  ) : (
                    msg.text
                  )}
                </div>
              ))}
              <div ref={messagesEndRef} />
            </div>
            
            <div id="input-area">
              <input 
                value={input} 
                disabled={isTyping}
                onChange={(e) => setInput(e.target.value)}
                onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
                placeholder={isTyping ? "Î ÎµÏÎ¹Î¼Î­Î½ÎµÏ„Îµ..." : "ÎœÎ®Î½Ï…Î¼Î±..."}
              />
              <button className="send-btn" onClick={sendMessage} disabled={isTyping || !input.trim()}>
                {isTyping ? "..." : "Î£Ï„ÎµÎ¯Î»Îµ"}
              </button>
            </div>
          </div>
        </React.Fragment>
      );
    }

    const root = createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>